<template>
  <header class="bg-white shadow-md">
    <!-- Top Header -->
    <!-- MOBILE HEADER -->
    <div class="grid sm:grid md:grid lg:hidden px-4 py-3 grid-cols-4 relative py-8">
      <!-- Menú hamburguesa -->
      <button @click="toggleMobileMenu" class="mr-2 col-span-1" v-if="isMobile">
        <svg width="34" height="28" viewBox="0 0 34 28" fill="none" xmlns="http://www.w3.org/2000/svg"
          v-if="!mobileMenuOpen">
          <rect width="34" height="6" rx="2" fill="#272A30" />
          <rect y="11" width="34" height="6" rx="2" fill="#272A30" />
          <rect y="22" width="34" height="6" rx="2" fill="#272A30" />
        </svg>
        <svg v-else width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect x="15.0437" y="0.302734" width="1" height="20.8517" rx="0.5" transform="rotate(45 15.0437 0.302734)"
            fill="#CCCCCC" />
          <rect x="15.3162" y="14.9961" width="1" height="20.7454" rx="0.5" transform="rotate(135 15.3162 14.9961)"
            fill="#CCCCCC" />
        </svg>
      </button>
      <!--Sidebar Menu (Mobile & Desktop)-->
      <Transition name="mobile-menu">
        <div v-if="mobileMenuOpen" class="fixed top-0 left-0 bg-white h-full shadow-lg z-[9999] overflow-y-auto"
             :class="isMobile ? 'w-4/5' : 'w-80'">
          <!-- Header del menú lateral -->
          <div class="flex justify-between items-center p-4 border-b border-gray-100">
            <h3 class="font-semibold text-gray-800">Todas las categorías</h3>
            <button @click="closeMobileMenu" class="p-2">
              <svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect x="15.0437" y="0.302734" width="1" height="20.8517" rx="0.5"
                  transform="rotate(45 15.0437 0.302734)" fill="#CCCCCC" />
                <rect x="15.3162" y="14.9961" width="1" height="20.7454" rx="0.5"
                  transform="rotate(135 15.3162 14.9961)" fill="#CCCCCC" />
              </svg>
            </button>
          </div>

          <!-- Usuario -->
          <div class="flex items-center gap-4 p-4 border-b border-gray-100">
            <svg width="30" height="34" viewBox="0 0 30 34" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M28.0812 32.0798V28.7472C28.0812 26.9795 27.3942 25.2842 26.1714 24.0342C24.9486 22.7843 23.2902 22.082 21.5609 22.082H8.5203C6.79101 22.082 5.13254 22.7843 3.90975 24.0342C2.68696 25.2842 2 26.9795 2 28.7472V32.0798"
                stroke="#272A30" stroke-width="2.60812" stroke-linecap="round" stroke-linejoin="round" />
              <path
                d="M15.0406 15.4202C18.6416 15.4202 21.5609 12.4361 21.5609 8.75504C21.5609 5.07395 18.6416 2.08984 15.0406 2.08984C11.4395 2.08984 8.52026 5.07395 8.52026 8.75504C8.52026 12.4361 11.4395 15.4202 15.0406 15.4202Z"
                stroke="#272A30" stroke-width="2.60812" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
            <span class="font-medium"
            @click="userName ? '' : $router.push('/login')"
            >{{ userName ? userName : 'Iniciar sesión' }}</span>
          </div>

          <!-- Categorías desplegable -->
          <div class="border-b border-gray-100">
            <button @click="toggleCategoriesMobile" class="w-full flex justify-between items-center p-4 text-left">
              <span class="font-medium text-gray-800">Categorías</span>
              <Icon :name="categoriesMobileOpen ? 'heroicons:chevron-up' : 'heroicons:chevron-down'"
                class="w-5 h-5 text-gray-500 transition-transform duration-200"
                :class="{ 'rotate-180': categoriesMobileOpen }" />
            </button>
            <Transition name="dropdown">
              <div v-if="categoriesMobileOpen" class="bg-gray-50 overflow-hidden">
                <NuxtLink v-for="category in categories" :key="category.id" :to="`/category/${category.slug}`"
                  @click="closeMobileMenu"
                  class="block px-6 py-3 text-gray-700 hover:bg-gray-100 hover:text-secondary transition-all duration-200 transform hover:translate-x-1">
                  {{ category.name }}
                </NuxtLink>
              </div>
            </Transition>
          </div>

          <!-- Redes sociales desplegable -->
          <div class="border-b border-gray-100">
            <button @click="toggleSocialMobile" class="w-full flex justify-between items-center p-4 text-left">
              <span class="font-medium text-gray-800">Redes sociales</span>
              <Icon :name="socialMobileOpen ? 'heroicons:chevron-up' : 'heroicons:chevron-down'"
                class="w-5 h-5 text-gray-500 transition-transform duration-200"
                :class="{ 'rotate-180': socialMobileOpen }" />
            </button>
            <Transition name="dropdown">
              <div v-if="socialMobileOpen" class="bg-gray-50 overflow-hidden">
                <a v-for="social in socialMedia" :key="social.name" :href="social.url"
                  target="_blank"
                  class="group flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100 hover:text-secondary transition-all duration-200 transform hover:translate-x-1">
                  <Icon :name="social.icon"
                    class="w-5 h-5 mr-3 transition-transform duration-200 group-hover:scale-110" />
                  {{ social.name }}
                </a>
              </div>
            </Transition>
          </div>

          <!-- Enlaces adicionales -->
          <div class="p-4">
            <NuxtLink to="/account" class="flex items-center gap-3 py-3 text-gray-700 hover:bg-gray-50 transition text-base border-b border-gray-100">
              <Icon name="heroicons:user-circle" class="w-5 h-5" />
              Mi cuenta
            </NuxtLink>
            <NuxtLink to="/wishlist" @click="closeMobileMenu"
              class="flex items-center gap-3 py-3 text-gray-700 hover:text-secondary transition">
              <Icon name="heroicons:heart" class="w-5 h-5" />
              Lista de deseos
            </NuxtLink>
            <NuxtLink to="/orders" @click="closeMobileMenu"
              class="flex items-center gap-3 py-3 text-gray-700 hover:text-secondary transition">
              <Icon name="heroicons:cube" class="w-5 h-5" />
              Pedidos
            </NuxtLink>
            <button @click="logout"
              class="flex items-center gap-3 py-3 w-full text-left text-gray-700 hover:text-secondary transition">
              <Icon name="heroicons:arrow-left-on-rectangle" class="w-5 h-5" />
              Cerrar sesión
            </button>
          </div>
        </div>
      </Transition>

      <!-- Backdrop -->
      <Transition name="mobile-menu">
        <div v-if="mobileMenuOpen" @click="closeMobileMenu" class="fixed inset-0 bg-black bg-opacity-50 z-[9998]"></div>
      </Transition>

      <!-- Logo centrado -->
      <NuxtLink to="/"
        class="flex-1 flex justify-center col-span-2 sm:col-span-2 md:col-span-1 lg:col-span-2 items-center">
        <svg width="171" height="32" viewBox="0 0 171 32" fill="none" xmlns="http://www.w3.org/2000/svg">
          <g clip-path="url(#clip0_3754_5922)">
            <path
              d="M11.9966 11.4964C11.5052 10.9614 10.9201 10.545 10.2399 10.2441C9.55965 9.94465 8.80141 9.79419 7.96672 9.79419C7.02907 9.79419 6.18814 9.99785 5.44082 10.4036C4.6935 10.8094 4.10064 11.4158 3.66224 12.2229C3.51402 12.4964 3.39389 12.7989 3.28936 13.1135V10.1362H0.499786V26.14H4.01327V20.3874C4.41891 20.9558 4.91661 21.3981 5.51727 21.7005C6.24274 22.0638 7.05715 22.2461 7.96672 22.2461C8.8763 22.2461 9.62518 22.0926 10.3054 21.7856C10.9856 21.4786 11.5645 21.0546 12.0403 20.5135C12.5162 19.971 12.8781 19.3342 13.1277 18.5986C13.3758 17.8645 13.5006 17.0757 13.5006 16.2337V15.7413C13.5006 14.8856 13.3727 14.0983 13.1168 13.3779C12.861 12.6575 12.4865 12.0299 11.9966 11.4949V11.4964ZM9.59241 17.7551C9.34279 18.2688 8.99487 18.6685 8.54867 18.9527C8.10246 19.2384 7.57824 19.3813 6.97914 19.3813C6.48145 19.3813 5.9978 19.2673 5.52975 19.0393C5.0617 18.8113 4.67634 18.48 4.37679 18.0438C4.07568 17.6092 3.9259 17.0848 3.9259 16.4708V15.679C3.9259 15.0376 4.06944 14.492 4.35495 14.0421C4.64046 13.5922 5.01802 13.2472 5.48607 13.0041C5.95411 12.7609 6.45181 12.6408 6.97914 12.6408C7.59385 12.6408 8.12118 12.7791 8.56115 13.0588C8.99955 13.3369 9.34435 13.726 9.59397 14.2245C9.84204 14.7245 9.96685 15.3081 9.96685 15.9784C9.96685 16.6486 9.84204 17.2398 9.59397 17.7535L9.59241 17.7551Z"
              fill="#111111" />
            <path
              d="M18.8706 11.3369C18.323 12.0147 17.9844 12.9084 17.8502 14.0178V10.1392H15.0607V21.8632H18.5742V15.8948C18.5742 14.9389 18.8378 14.2078 19.3652 13.7017C19.8925 13.1956 20.6398 12.9418 21.6056 12.9418H22.4839V9.98877H22.0221C20.6461 9.98877 19.5945 10.4386 18.8706 11.3369Z"
              fill="#111111" />
            <path
              d="M34.0806 11.5282C33.5096 10.9719 32.8169 10.5327 32.0056 10.212C31.1928 9.89133 30.2676 9.73022 29.227 9.73022C28.1863 9.73022 27.3017 9.89133 26.4811 10.212C25.6604 10.5327 24.9615 10.9719 24.3842 11.5282C23.8054 12.0844 23.367 12.7304 23.0674 13.4644C22.7663 14.1985 22.6166 14.9721 22.6166 15.7852V16.2776C22.6166 17.0771 22.7632 17.837 23.055 18.5559C23.3483 19.2763 23.7758 19.9146 24.3405 20.4709C24.9038 21.0271 25.5965 21.4663 26.4156 21.787C27.2346 22.1077 28.1723 22.2688 29.227 22.2688C30.2816 22.2688 31.2396 22.1077 32.0602 21.787C32.8809 21.4663 33.572 21.0271 34.1352 20.4709C34.6985 19.9146 35.1275 19.2763 35.4208 18.5559C35.7141 17.8355 35.8592 17.0756 35.8592 16.2776V15.7852C35.8592 14.9721 35.7063 14.1985 35.3974 13.4644C35.0901 12.7304 34.6501 12.0844 34.0806 11.5282ZM31.9838 17.7534C31.742 18.2671 31.394 18.6668 30.94 18.951C30.486 19.2368 29.915 19.3796 29.227 19.3796C28.5389 19.3796 28.0038 19.2368 27.5358 18.951C27.0677 18.6653 26.7151 18.2671 26.4811 17.7534C26.2471 17.2397 26.13 16.6698 26.13 16.0421C26.13 15.3718 26.2502 14.7837 26.492 14.2776C26.7338 13.7715 27.088 13.3687 27.5576 13.0693C28.0256 12.7699 28.5826 12.6194 29.227 12.6194C29.8713 12.6194 30.4455 12.7699 30.9073 13.0693C31.3675 13.3687 31.7232 13.7715 31.9729 14.2776C32.2225 14.7837 32.3457 15.3718 32.3457 16.0421C32.3457 16.6698 32.2256 17.2397 31.9838 17.7534Z"
              fill="#111111" />
            <path
              d="M48.9709 11.4751C48.5013 10.9402 47.935 10.5268 47.2688 10.2334C46.6026 9.94164 45.86 9.79574 45.0393 9.79574C44.1017 9.79574 43.267 9.99939 42.5353 10.4052C41.88 10.7699 41.3574 11.3034 40.9533 11.9873V6.2439H37.4398V21.8617H40.2294V19.3007C40.3074 19.4998 40.3932 19.6913 40.493 19.8707C40.9174 20.6412 41.5025 21.2294 42.2498 21.6352C42.9971 22.041 43.8599 22.2447 44.8412 22.2447C45.7055 22.2447 46.4809 22.0912 47.169 21.7842C47.857 21.4771 48.4467 21.0501 48.9366 20.4999C49.4265 19.9512 49.801 19.3129 50.0568 18.5849C50.3127 17.8569 50.4406 17.0666 50.4406 16.2094V15.7383C50.4406 14.8826 50.3127 14.0908 50.0568 13.3643C49.801 12.6363 49.4374 12.0056 48.9694 11.4706L48.9709 11.4751ZM46.5324 17.7444C46.2828 18.2657 45.9349 18.6685 45.4887 18.9527C45.0425 19.2384 44.5182 19.3813 43.9191 19.3813C43.4214 19.3813 42.9378 19.2673 42.4698 19.0393C42.0017 18.8114 41.6163 18.48 41.3168 18.0439C41.0157 17.6092 40.8659 17.0848 40.8659 16.4708V15.679C40.8659 15.0376 41.0094 14.492 41.295 14.0421C41.5805 13.5923 41.958 13.2473 42.4261 13.0041C42.8941 12.7609 43.3918 12.6409 43.9191 12.6409C44.5198 12.6409 45.0425 12.7792 45.4887 13.0588C45.9349 13.3369 46.2828 13.726 46.5324 14.2245C46.7805 14.7245 46.9053 15.3082 46.9053 15.9784C46.9053 16.6486 46.7805 17.2231 46.5324 17.7429V17.7444Z"
              fill="#111111" />
            <path
              d="M59.4023 17.027C59.4023 17.6836 59.2041 18.2034 58.8094 18.5894C58.4147 18.9739 57.9014 19.1669 57.2727 19.1669C56.6439 19.1669 56.1665 18.9815 55.8014 18.6107C55.4348 18.2398 55.2523 17.7413 55.2523 17.1137V10.1392H51.7388V16.9419C51.7388 18.711 52.1116 20.0332 52.859 20.9102C53.6063 21.7871 54.675 22.2264 56.0651 22.2264H56.2196C57.1276 22.2264 57.8889 22.0333 58.5036 21.6488C59.1183 21.2643 59.5833 20.6746 59.8984 19.8843C59.9905 19.6548 60.0638 19.4025 60.1293 19.1396V21.8631H62.9189V10.1392H59.4054V17.0285L59.4023 17.027Z"
              fill="#111111" />
            <path
              d="M73.9849 15.8083C73.1643 15.1669 72.016 14.7672 70.5369 14.6107L69.593 14.5256C68.9627 14.4541 68.5087 14.3325 68.231 14.1623C67.9533 13.9906 67.8129 13.7413 67.8129 13.413C67.8129 13.0848 67.9736 12.8005 68.2965 12.5999C68.6179 12.4008 69.0501 12.3005 69.5915 12.3005C70.2795 12.3005 70.799 12.4327 71.1501 12.6957C71.5011 12.9601 71.7071 13.2839 71.7648 13.6699H74.8835C74.8399 12.4145 74.3422 11.4555 73.3905 10.7929C72.4388 10.1302 71.186 9.79736 69.6352 9.79736C68.6694 9.79736 67.8082 9.94023 67.0547 10.2244C66.3011 10.5102 65.7114 10.9312 65.287 11.4859C64.8626 12.0422 64.6504 12.7337 64.6504 13.562C64.6504 14.5605 65.0124 15.3812 65.7379 16.0226C66.4634 16.664 67.5492 17.0576 68.9986 17.1989L69.9425 17.284C70.7335 17.3692 71.2827 17.5166 71.59 17.7233C71.8974 17.93 72.0503 18.2051 72.0503 18.547C72.0503 18.9315 71.849 19.2279 71.4465 19.4346C71.044 19.6413 70.5354 19.7446 69.9207 19.7446C69.1156 19.7446 68.5118 19.5987 68.1078 19.3069C67.7052 19.0151 67.4743 18.6823 67.4166 18.3114H64.2979C64.3556 19.5516 64.8689 20.5152 65.8346 21.1991C66.8003 21.883 68.1405 22.2265 69.8536 22.2265C70.9363 22.2265 71.8818 22.073 72.6868 21.766C73.4919 21.459 74.1144 21.0167 74.5544 20.4392C74.9928 19.8617 75.2127 19.1808 75.2127 18.3966C75.2127 17.3129 74.8024 16.4497 73.9833 15.8083H73.9849Z"
              fill="#111111" />
            <path
              d="M78.5547 8.98254C79.2131 8.98254 79.6998 8.81536 80.015 8.47948C80.3301 8.14512 80.4877 7.71956 80.4877 7.20738C80.4877 6.6952 80.3301 6.24837 80.015 5.91249C79.6998 5.57813 79.2131 5.40942 78.5547 5.40942C77.8963 5.40942 77.408 5.57661 77.0944 5.91249C76.7792 6.24837 76.6216 6.68 76.6216 7.20738C76.6216 7.73476 76.7792 8.14512 77.0944 8.47948C77.4095 8.81536 77.8963 8.98254 78.5547 8.98254Z"
              fill="#111111" />
            <path d="M75.5889 10.1375V12.6619H77.1927V21.8614H80.7062V12.6619V10.1375H77.1927H75.5889Z"
              fill="#111111" />
            <path
              d="M90.0844 9.77452H89.9299C89.0079 9.77452 88.2247 9.97514 87.5803 10.3733C86.936 10.7731 86.457 11.3719 86.1419 12.1698C86.0264 12.4616 85.9406 12.7883 85.8673 13.1318V10.1362H83.0777V21.8602H86.5912V15.0347C86.5912 14.3781 86.7924 13.8477 87.195 13.4404C87.5975 13.0346 88.1279 12.8309 88.7879 12.8309C89.4478 12.8309 89.944 13.0315 90.3247 13.4297C90.7053 13.8294 90.8957 14.3431 90.8957 14.9708V21.8602H94.4092V15.1638C94.4092 13.3522 94.0394 12.0011 93.2999 11.1089C92.5604 10.2183 91.4885 9.77148 90.0828 9.77148L90.0844 9.77452Z"
              fill="#111111" />
            <path
              d="M105.162 10.5767C104.276 10.0129 103.188 9.73169 101.901 9.73169C100.92 9.73169 100.046 9.89887 99.2767 10.2348C98.5076 10.5706 97.8679 11.0235 97.3546 11.5935C96.8413 12.1634 96.4497 12.8093 96.1798 13.5297C95.9083 14.2501 95.7742 15.0025 95.7742 15.7867V16.2153C95.7742 16.9722 95.9099 17.7093 96.1798 18.4297C96.4513 19.1501 96.846 19.799 97.3655 20.3766C97.8851 20.9541 98.5372 21.4146 99.3204 21.7566C100.104 22.0985 101.009 22.2703 102.032 22.2703C103.055 22.2703 103.935 22.0985 104.712 21.7566C105.488 21.4146 106.132 20.9359 106.645 20.3234C107.157 19.7109 107.502 19.0118 107.678 18.2275H104.45C104.304 18.5847 104.026 18.8841 103.616 19.1258C103.205 19.3689 102.678 19.489 102.034 19.489C101.331 19.489 100.759 19.3461 100.32 19.0619C99.8821 18.7762 99.5591 18.3734 99.3547 17.8537C99.2409 17.5649 99.1613 17.2457 99.1114 16.9022H107.898V15.7472C107.898 14.6772 107.664 13.6893 107.196 12.7835C106.727 11.8777 106.049 11.1436 105.165 10.5798L105.162 10.5767ZM99.375 14.1073C99.595 13.586 99.9164 13.1908 100.341 12.9203C100.765 12.6498 101.285 12.513 101.899 12.513C102.514 12.513 103.001 12.6452 103.403 12.9081C103.806 13.1726 104.11 13.5541 104.314 14.0526C104.425 14.3216 104.503 14.6225 104.555 14.9508H99.1316C99.1862 14.6423 99.2658 14.3596 99.3735 14.1058L99.375 14.1073Z"
              fill="#111111" />
            <path
              d="M118.042 15.8083C117.222 15.1669 116.073 14.7672 114.594 14.6107L113.651 14.5256C113.02 14.4541 112.566 14.3325 112.289 14.1623C112.011 13.9906 111.87 13.7413 111.87 13.413C111.87 13.0848 112.031 12.8005 112.354 12.5999C112.675 12.4008 113.108 12.3005 113.649 12.3005C114.337 12.3005 114.857 12.4327 115.208 12.6957C115.559 12.9601 115.765 13.2839 115.822 13.6699H118.941C118.897 12.4145 118.4 11.4555 117.448 10.7929C116.496 10.1302 115.243 9.79736 113.693 9.79736C112.727 9.79736 111.866 9.94023 111.112 10.2244C110.359 10.5102 109.769 10.9312 109.344 11.4859C108.92 12.0422 108.708 12.7337 108.708 13.562C108.708 14.5605 109.07 15.3812 109.795 16.0226C110.521 16.664 111.607 17.0576 113.056 17.1989L114 17.284C114.791 17.3692 115.34 17.5166 115.648 17.7233C115.955 17.93 116.108 18.2051 116.108 18.547C116.108 18.9315 115.907 19.2279 115.504 19.4346C115.101 19.6413 114.593 19.7446 113.978 19.7446C113.173 19.7446 112.569 19.5987 112.165 19.3069C111.763 19.0151 111.532 18.6823 111.474 18.3114H108.355C108.413 19.5516 108.926 20.5152 109.892 21.1991C110.858 21.883 112.198 22.2265 113.911 22.2265C114.994 22.2265 115.939 22.073 116.744 21.766C117.549 21.459 118.172 21.0167 118.612 20.4392C119.052 19.8617 119.27 19.1808 119.27 18.3966C119.27 17.3129 118.86 16.4497 118.041 15.8083H118.042Z"
              fill="#111111" />
            <path
              d="M129.376 15.8083C128.555 15.1669 127.407 14.7672 125.928 14.6107L124.984 14.5256C124.353 14.4541 123.899 14.3325 123.622 14.1623C123.344 13.9906 123.204 13.7413 123.204 13.413C123.204 13.0848 123.364 12.8005 123.687 12.5999C124.009 12.4008 124.441 12.3005 124.982 12.3005C125.67 12.3005 126.19 12.4327 126.541 12.6957C126.892 12.9601 127.098 13.2839 127.155 13.6699H130.274C130.231 12.4145 129.733 11.4555 128.781 10.7929C127.829 10.1302 126.577 9.79736 125.026 9.79736C124.06 9.79736 123.199 9.94023 122.445 10.2244C121.692 10.5102 121.102 10.9312 120.678 11.4859C120.253 12.0422 120.041 12.7337 120.041 13.562C120.041 14.5605 120.403 15.3812 121.129 16.0226C121.854 16.664 122.94 17.0576 124.389 17.1989L125.333 17.284C126.124 17.3692 126.673 17.5166 126.981 17.7233C127.288 17.93 127.441 18.2051 127.441 18.547C127.441 18.9315 127.24 19.2279 126.837 19.4346C126.435 19.6413 125.926 19.7446 125.311 19.7446C124.506 19.7446 123.903 19.5987 123.498 19.3069C123.096 19.0151 122.865 18.6823 122.807 18.3114H119.689C119.746 19.5516 120.26 20.5152 121.225 21.1991C122.191 21.883 123.531 22.2265 125.244 22.2265C126.327 22.2265 127.272 22.073 128.077 21.766C128.883 21.459 129.505 21.0167 129.945 20.4392C130.385 19.8617 130.603 19.1808 130.603 18.3966C130.603 17.3129 130.193 16.4497 129.374 15.8083H129.376Z"
              fill="#111111" />
            <path
              d="M170.478 18.521L160.401 18.518L167.525 25.5198L163.805 29.1127L156.66 22.1428V32.0019H151.433V22.1641L144.289 29.1036L140.601 25.4803L147.756 18.5226H137.635L137.657 13.425L146.205 13.46C146.592 13.84 153.833 20.9558 153.968 21.0895C155.713 19.3965 160.077 15.1972 161.882 13.457L170.5 13.46L170.478 18.5226V18.521Z"
              fill="#111111" />
            <path
              d="M156.655 9.82138L156.66 0.00632346L151.432 0.000244141V9.83658L144.324 2.8712L140.604 6.46408L153.969 19.5984L155.859 17.7731L167.529 6.50359L163.843 2.88032L156.655 9.82138Z"
              fill="#FF500B" />
          </g>
          <defs>
            <clipPath id="clip0_3754_5922">
              <rect width="170" height="32" fill="white" transform="translate(0.499939 0.000244141)" />
            </clipPath>
          </defs>
        </svg>
      </NuxtLink>
      <CartButton  v-if="isMobile" class="flex justify-end"/>
      <!-- Barra de búsqueda para tablet -->
      <div class="flex sm:flex md:flex lg:hidden px-4 col-span-2 items-center" v-if="isTablet">
        <div class="flex items-center bg-white rounded shadow overflow-hidden w-full">
          <input type="text" placeholder="Escribe el nombre de lo que buscas"
            class="flex-1 px-3 py-2 text-sm outline-none" />
          <button class="bg-[#FF5C00] p-2 flex items-center justify-center">
            <Icon name="heroicons:magnifying-glass-20-solid" class="w-5 h-5 text-white" />
          </button>
        </div>
      </div>

      <!-- Carrito y menú hamburguesa para tablet -->
      <div class="ml-2 flex col-span-1 justify-end gap-5 items-center" v-if="isTablet">
        <CartButton />
        <button @click="toggleMobileMenu" class="mr-2" v-if="isTablet">
          <svg width="34" height="28" viewBox="0 0 34 28" fill="none" xmlns="http://www.w3.org/2000/svg"
            v-if="!mobileMenuOpen">
            <rect width="34" height="6" rx="2" fill="#272A30" />
            <rect y="11" width="34" height="6" rx="2" fill="#272A30" />
            <rect y="22" width="34" height="6" rx="2" fill="#272A30" />
          </svg>
          <svg v-else width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="15.0437" y="0.302734" width="1" height="20.8517" rx="0.5" transform="rotate(45 15.0437 0.302734)"
              fill="#CCCCCC" />
            <rect x="15.3162" y="14.9961" width="1" height="20.7454" rx="0.5" transform="rotate(135 15.3162 14.9961)"
              fill="#CCCCCC" />
          </svg>
        </button>
      </div>

      <!-- Barra de búsqueda para móvil -->
      <div class="flex sm:flex md:flex lg:hidden px-4 pb-2 col-span-4 mt-4 md:mt-0" v-if="isMobile">
        <div class="flex items-center bg-white rounded shadow overflow-hidden w-full">
          <input type="text" placeholder="Escribe el nombre de lo que buscas"
            class="flex-1 px-3 py-2 text-sm outline-none" />
          <button class="bg-[#FF5C00] p-2 flex items-center justify-center">
            <Icon name="heroicons:magnifying-glass-20-solid" class="w-5 h-5 text-white" />
          </button>
        </div>
      </div>
    </div>
    <!-- Barra de búsqueda móvil -->

    <!-- DESKTOP HEADER -->
    <div class="hidden sm:hidden md:hidden lg:grid items-center mx-auto justify-center py-8  lg:grid-cols-6 w-4/5"
      v-show="isTablet || isDesktop">
      <!-- Logo -->
      <NuxtLink to="/" class="flex-1 flex justify-center col-span-1">
        <svg width="171" height="32" viewBox="0 0 171 32" fill="none" xmlns="http://www.w3.org/2000/svg">
          <g clip-path="url(#clip0_3754_5922)">
            <path
              d="M11.9966 11.4964C11.5052 10.9614 10.9201 10.545 10.2399 10.2441C9.55965 9.94465 8.80141 9.79419 7.96672 9.79419C7.02907 9.79419 6.18814 9.99785 5.44082 10.4036C4.6935 10.8094 4.10064 11.4158 3.66224 12.2229C3.51402 12.4964 3.39389 12.7989 3.28936 13.1135V10.1362H0.499786V26.14H4.01327V20.3874C4.41891 20.9558 4.91661 21.3981 5.51727 21.7005C6.24274 22.0638 7.05715 22.2461 7.96672 22.2461C8.8763 22.2461 9.62518 22.0926 10.3054 21.7856C10.9856 21.4786 11.5645 21.0546 12.0403 20.5135C12.5162 19.971 12.8781 19.3342 13.1277 18.5986C13.3758 17.8645 13.5006 17.0757 13.5006 16.2337V15.7413C13.5006 14.8856 13.3727 14.0983 13.1168 13.3779C12.861 12.6575 12.4865 12.0299 11.9966 11.4949V11.4964ZM9.59241 17.7551C9.34279 18.2688 8.99487 18.6685 8.54867 18.9527C8.10246 19.2384 7.57824 19.3813 6.97914 19.3813C6.48145 19.3813 5.9978 19.2673 5.52975 19.0393C5.0617 18.8113 4.67634 18.48 4.37679 18.0438C4.07568 17.6092 3.9259 17.0848 3.9259 16.4708V15.679C3.9259 15.0376 4.06944 14.492 4.35495 14.0421C4.64046 13.5922 5.01802 13.2472 5.48607 13.0041C5.95411 12.7609 6.45181 12.6408 6.97914 12.6408C7.59385 12.6408 8.12118 12.7791 8.56115 13.0588C8.99955 13.3369 9.34435 13.726 9.59397 14.2245C9.84204 14.7245 9.96685 15.3081 9.96685 15.9784C9.96685 16.6486 9.84204 17.2398 9.59397 17.7535L9.59241 17.7551Z"
              fill="#111111" />
            <path
              d="M18.8706 11.3369C18.323 12.0147 17.9844 12.9084 17.8502 14.0178V10.1392H15.0607V21.8632H18.5742V15.8948C18.5742 14.9389 18.8378 14.2078 19.3652 13.7017C19.8925 13.1956 20.6398 12.9418 21.6056 12.9418H22.4839V9.98877H22.0221C20.6461 9.98877 19.5945 10.4386 18.8706 11.3369Z"
              fill="#111111" />
            <path
              d="M34.0806 11.5282C33.5096 10.9719 32.8169 10.5327 32.0056 10.212C31.1928 9.89133 30.2676 9.73022 29.227 9.73022C28.1863 9.73022 27.3017 9.89133 26.4811 10.212C25.6604 10.5327 24.9615 10.9719 24.3842 11.5282C23.8054 12.0844 23.367 12.7304 23.0674 13.4644C22.7663 14.1985 22.6166 14.9721 22.6166 15.7852V16.2776C22.6166 17.0771 22.7632 17.837 23.055 18.5559C23.3483 19.2763 23.7758 19.9146 24.3405 20.4709C24.9038 21.0271 25.5965 21.4663 26.4156 21.787C27.2346 22.1077 28.1723 22.2688 29.227 22.2688C30.2816 22.2688 31.2396 22.1077 32.0602 21.787C32.8809 21.4663 33.572 21.0271 34.1352 20.4709C34.6985 19.9146 35.1275 19.2763 35.4208 18.5559C35.7141 17.8355 35.8592 17.0756 35.8592 16.2776V15.7852C35.8592 14.9721 35.7063 14.1985 35.3974 13.4644C35.0901 12.7304 34.6501 12.0844 34.0806 11.5282ZM31.9838 17.7534C31.742 18.2671 31.394 18.6668 30.94 18.951C30.486 19.2368 29.915 19.3796 29.227 19.3796C28.5389 19.3796 28.0038 19.2368 27.5358 18.951C27.0677 18.6653 26.7151 18.2671 26.4811 17.7534C26.2471 17.2397 26.13 16.6698 26.13 16.0421C26.13 15.3718 26.2502 14.7837 26.492 14.2776C26.7338 13.7715 27.088 13.3687 27.5576 13.0693C28.0256 12.7699 28.5826 12.6194 29.227 12.6194C29.8713 12.6194 30.4455 12.7699 30.9073 13.0693C31.3675 13.3687 31.7232 13.7715 31.9729 14.2776C32.2225 14.7837 32.3457 15.3718 32.3457 16.0421C32.3457 16.6698 32.2256 17.2397 31.9838 17.7534Z"
              fill="#111111" />
            <path
              d="M48.9709 11.4751C48.5013 10.9402 47.935 10.5268 47.2688 10.2334C46.6026 9.94164 45.86 9.79574 45.0393 9.79574C44.1017 9.79574 43.267 9.99939 42.5353 10.4052C41.88 10.7699 41.3574 11.3034 40.9533 11.9873V6.2439H37.4398V21.8617H40.2294V19.3007C40.3074 19.4998 40.3932 19.6913 40.493 19.8707C40.9174 20.6412 41.5025 21.2294 42.2498 21.6352C42.9971 22.041 43.8599 22.2447 44.8412 22.2447C45.7055 22.2447 46.4809 22.0912 47.169 21.7842C47.857 21.4771 48.4467 21.0501 48.9366 20.4999C49.4265 19.9512 49.801 19.3129 50.0568 18.5849C50.3127 17.8569 50.4406 17.0666 50.4406 16.2094V15.7383C50.4406 14.8826 50.3127 14.0908 50.0568 13.3643C49.801 12.6363 49.4374 12.0056 48.9694 11.4706L48.9709 11.4751ZM46.5324 17.7444C46.2828 18.2657 45.9349 18.6685 45.4887 18.9527C45.0425 19.2384 44.5182 19.3813 43.9191 19.3813C43.4214 19.3813 42.9378 19.2673 42.4698 19.0393C42.0017 18.8114 41.6163 18.48 41.3168 18.0439C41.0157 17.6092 40.8659 17.0848 40.8659 16.4708V15.679C40.8659 15.0376 41.0094 14.492 41.295 14.0421C41.5805 13.5923 41.958 13.2473 42.4261 13.0041C42.8941 12.7609 43.3918 12.6409 43.9191 12.6409C44.5198 12.6409 45.0425 12.7792 45.4887 13.0588C45.9349 13.3369 46.2828 13.726 46.5324 14.2245C46.7805 14.7245 46.9053 15.3082 46.9053 15.9784C46.9053 16.6486 46.7805 17.2231 46.5324 17.7429V17.7444Z"
              fill="#111111" />
            <path
              d="M59.4023 17.027C59.4023 17.6836 59.2041 18.2034 58.8094 18.5894C58.4147 18.9739 57.9014 19.1669 57.2727 19.1669C56.6439 19.1669 56.1665 18.9815 55.8014 18.6107C55.4348 18.2398 55.2523 17.7413 55.2523 17.1137V10.1392H51.7388V16.9419C51.7388 18.711 52.1116 20.0332 52.859 20.9102C53.6063 21.7871 54.675 22.2264 56.0651 22.2264H56.2196C57.1276 22.2264 57.8889 22.0333 58.5036 21.6488C59.1183 21.2643 59.5833 20.6746 59.8984 19.8843C59.9905 19.6548 60.0638 19.4025 60.1293 19.1396V21.8631H62.9189V10.1392H59.4054V17.0285L59.4023 17.027Z"
              fill="#111111" />
            <path
              d="M73.9849 15.8083C73.1643 15.1669 72.016 14.7672 70.5369 14.6107L69.593 14.5256C68.9627 14.4541 68.5087 14.3325 68.231 14.1623C67.9533 13.9906 67.8129 13.7413 67.8129 13.413C67.8129 13.0848 67.9736 12.8005 68.2965 12.5999C68.6179 12.4008 69.0501 12.3005 69.5915 12.3005C70.2795 12.3005 70.799 12.4327 71.1501 12.6957C71.5011 12.9601 71.7071 13.2839 71.7648 13.6699H74.8835C74.8399 12.4145 74.3422 11.4555 73.3905 10.7929C72.4388 10.1302 71.186 9.79736 69.6352 9.79736C68.6694 9.79736 67.8082 9.94023 67.0547 10.2244C66.3011 10.5102 65.7114 10.9312 65.287 11.4859C64.8626 12.0422 64.6504 12.7337 64.6504 13.562C64.6504 14.5605 65.0124 15.3812 65.7379 16.0226C66.4634 16.664 67.5492 17.0576 68.9986 17.1989L69.9425 17.284C70.7335 17.3692 71.2827 17.5166 71.59 17.7233C71.8974 17.93 72.0503 18.2051 72.0503 18.547C72.0503 18.9315 71.849 19.2279 71.4465 19.4346C71.044 19.6413 70.5354 19.7446 69.9207 19.7446C69.1156 19.7446 68.5118 19.5987 68.1078 19.3069C67.7052 19.0151 67.4743 18.6823 67.4166 18.3114H64.2979C64.3556 19.5516 64.8689 20.5152 65.8346 21.1991C66.8003 21.883 68.1405 22.2265 69.8536 22.2265C70.9363 22.2265 71.8818 22.073 72.6868 21.766C73.4919 21.459 74.1144 21.0167 74.5544 20.4392C74.9928 19.8617 75.2127 19.1808 75.2127 18.3966C75.2127 17.3129 74.8024 16.4497 73.9833 15.8083H73.9849Z"
              fill="#111111" />
            <path
              d="M78.5547 8.98254C79.2131 8.98254 79.6998 8.81536 80.015 8.47948C80.3301 8.14512 80.4877 7.71956 80.4877 7.20738C80.4877 6.6952 80.3301 6.24837 80.015 5.91249C79.6998 5.57813 79.2131 5.40942 78.5547 5.40942C77.8963 5.40942 77.408 5.57661 77.0944 5.91249C76.7792 6.24837 76.6216 6.68 76.6216 7.20738C76.6216 7.73476 76.7792 8.14512 77.0944 8.47948C77.4095 8.81536 77.8963 8.98254 78.5547 8.98254Z"
              fill="#111111" />
            <path d="M75.5889 10.1375V12.6619H77.1927V21.8614H80.7062V12.6619V10.1375H77.1927H75.5889Z"
              fill="#111111" />
            <path
              d="M90.0844 9.77452H89.9299C89.0079 9.77452 88.2247 9.97514 87.5803 10.3733C86.936 10.7731 86.457 11.3719 86.1419 12.1698C86.0264 12.4616 85.9406 12.7883 85.8673 13.1318V10.1362H83.0777V21.8602H86.5912V15.0347C86.5912 14.3781 86.7924 13.8477 87.195 13.4404C87.5975 13.0346 88.1279 12.8309 88.7879 12.8309C89.4478 12.8309 89.944 13.0315 90.3247 13.4297C90.7053 13.8294 90.8957 14.3431 90.8957 14.9708V21.8602H94.4092V15.1638C94.4092 13.3522 94.0394 12.0011 93.2999 11.1089C92.5604 10.2183 91.4885 9.77148 90.0828 9.77148L90.0844 9.77452Z"
              fill="#111111" />
            <path
              d="M105.162 10.5767C104.276 10.0129 103.188 9.73169 101.901 9.73169C100.92 9.73169 100.046 9.89887 99.2767 10.2348C98.5076 10.5706 97.8679 11.0235 97.3546 11.5935C96.8413 12.1634 96.4497 12.8093 96.1798 13.5297C95.9083 14.2501 95.7742 15.0025 95.7742 15.7867V16.2153C95.7742 16.9722 95.9099 17.7093 96.1798 18.4297C96.4513 19.1501 96.846 19.799 97.3655 20.3766C97.8851 20.9541 98.5372 21.4146 99.3204 21.7566C100.104 22.0985 101.009 22.2703 102.032 22.2703C103.055 22.2703 103.935 22.0985 104.712 21.7566C105.488 21.4146 106.132 20.9359 106.645 20.3234C107.157 19.7109 107.502 19.0118 107.678 18.2275H104.45C104.304 18.5847 104.026 18.8841 103.616 19.1258C103.205 19.3689 102.678 19.489 102.034 19.489C101.331 19.489 100.759 19.3461 100.32 19.0619C99.8821 18.7762 99.5591 18.3734 99.3547 17.8537C99.2409 17.5649 99.1613 17.2457 99.1114 16.9022H107.898V15.7472C107.898 14.6772 107.664 13.6893 107.196 12.7835C106.727 11.8777 106.049 11.1436 105.165 10.5798L105.162 10.5767ZM99.375 14.1073C99.595 13.586 99.9164 13.1908 100.341 12.9203C100.765 12.6498 101.285 12.513 101.899 12.513C102.514 12.513 103.001 12.6452 103.403 12.9081C103.806 13.1726 104.11 13.5541 104.314 14.0526C104.425 14.3216 104.503 14.6225 104.555 14.9508H99.1316C99.1862 14.6423 99.2658 14.3596 99.3735 14.1058L99.375 14.1073Z"
              fill="#111111" />
            <path
              d="M118.042 15.8083C117.222 15.1669 116.073 14.7672 114.594 14.6107L113.651 14.5256C113.02 14.4541 112.566 14.3325 112.289 14.1623C112.011 13.9906 111.87 13.7413 111.87 13.413C111.87 13.0848 112.031 12.8005 112.354 12.5999C112.675 12.4008 113.108 12.3005 113.649 12.3005C114.337 12.3005 114.857 12.4327 115.208 12.6957C115.559 12.9601 115.765 13.2839 115.822 13.6699H118.941C118.897 12.4145 118.4 11.4555 117.448 10.7929C116.496 10.1302 115.243 9.79736 113.693 9.79736C112.727 9.79736 111.866 9.94023 111.112 10.2244C110.359 10.5102 109.769 10.9312 109.344 11.4859C108.92 12.0422 108.708 12.7337 108.708 13.562C108.708 14.5605 109.07 15.3812 109.795 16.0226C110.521 16.664 111.607 17.0576 113.056 17.1989L114 17.284C114.791 17.3692 115.34 17.5166 115.648 17.7233C115.955 17.93 116.108 18.2051 116.108 18.547C116.108 18.9315 115.907 19.2279 115.504 19.4346C115.101 19.6413 114.593 19.7446 113.978 19.7446C113.173 19.7446 112.569 19.5987 112.165 19.3069C111.763 19.0151 111.532 18.6823 111.474 18.3114H108.355C108.413 19.5516 108.926 20.5152 109.892 21.1991C110.858 21.883 112.198 22.2265 113.911 22.2265C114.994 22.2265 115.939 22.073 116.744 21.766C117.549 21.459 118.172 21.0167 118.612 20.4392C119.052 19.8617 119.27 19.1808 119.27 18.3966C119.27 17.3129 118.86 16.4497 118.041 15.8083H118.042Z"
              fill="#111111" />
            <path
              d="M129.376 15.8083C128.555 15.1669 127.407 14.7672 125.928 14.6107L124.984 14.5256C124.353 14.4541 123.899 14.3325 123.622 14.1623C123.344 13.9906 123.204 13.7413 123.204 13.413C123.204 13.0848 123.364 12.8005 123.687 12.5999C124.009 12.4008 124.441 12.3005 124.982 12.3005C125.67 12.3005 126.19 12.4327 126.541 12.6957C126.892 12.9601 127.098 13.2839 127.155 13.6699H130.274C130.231 12.4145 129.733 11.4555 128.781 10.7929C127.829 10.1302 126.577 9.79736 125.026 9.79736C124.06 9.79736 123.199 9.94023 122.445 10.2244C121.692 10.5102 121.102 10.9312 120.678 11.4859C120.253 12.0422 120.041 12.7337 120.041 13.562C120.041 14.5605 120.403 15.3812 121.129 16.0226C121.854 16.664 122.94 17.0576 124.389 17.1989L125.333 17.284C126.124 17.3692 126.673 17.5166 126.981 17.7233C127.288 17.93 127.441 18.2051 127.441 18.547C127.441 18.9315 127.24 19.2279 126.837 19.4346C126.435 19.6413 125.926 19.7446 125.311 19.7446C124.506 19.7446 123.903 19.5987 123.498 19.3069C123.096 19.0151 122.865 18.6823 122.807 18.3114H119.689C119.746 19.5516 120.26 20.5152 121.225 21.1991C122.191 21.883 123.531 22.2265 125.244 22.2265C126.327 22.2265 127.272 22.073 128.077 21.766C128.883 21.459 129.505 21.0167 129.945 20.4392C130.385 19.8617 130.603 19.1808 130.603 18.3966C130.603 17.3129 130.193 16.4497 129.374 15.8083H129.376Z"
              fill="#111111" />
            <path
              d="M170.478 18.521L160.401 18.518L167.525 25.5198L163.805 29.1127L156.66 22.1428V32.0019H151.433V22.1641L144.289 29.1036L140.601 25.4803L147.756 18.5226H137.635L137.657 13.425L146.205 13.46C146.592 13.84 153.833 20.9558 153.968 21.0895C155.713 19.3965 160.077 15.1972 161.882 13.457L170.5 13.46L170.478 18.5226V18.521Z"
              fill="#111111" />
            <path
              d="M156.655 9.82138L156.66 0.00632346L151.432 0.000244141V9.83658L144.324 2.8712L140.604 6.46408L153.969 19.5984L155.859 17.7731L167.529 6.50359L163.843 2.88032L156.655 9.82138Z"
              fill="#FF500B" />
          </g>
          <defs>
            <clipPath id="clip0_3754_5922">
              <rect width="170" height="32" fill="white" transform="translate(0.499939 0.000244141)" />
            </clipPath>
          </defs>
        </svg>

      </NuxtLink>
      <!-- Search Bar -->
      <div class="flex-1 mx-8 col-span-3">
        <SearchBar />
      </div>
      <!-- User/Cart/Redes (solo desktop) -->
      <div class="flex items-center gap-10 col-span-2 justify-center ">
        <div v-if="userName" class="relative flex items-center gap-2 text-sm font-medium text-gray-700">
          <button class="flex items-center gap-2 focus:outline-none px-2 py-1 rounded-lg hover:bg-gray-100 transition"
            @click="userMenuOpen = !userMenuOpen" @blur="userMenuOpen = false" tabindex="0">
            <Icon name="heroicons:user" class="w-6 h-6 text-secondary" />
            <span class="font-medium text-gray-800">{{ userName }}</span>
            <Icon :name="userMenuOpen ? 'heroicons:chevron-up' : 'heroicons:chevron-down'"
              class="w-5 h-5 text-gray-500 ml-1" />
          </button>
          <div v-show="userMenuOpen"
            class="absolute top-[15px] right-0 mt-3 min-w-[200px] bg-white shadow-xl rounded-xl z-30 py-2 px-0 animate-fade-in border border-gray-100">
            
            <button @mousedown.prevent="goToWishlist"
              class="flex items-center gap-3 px-5 py-3 text-gray-700 hover:bg-gray-50 transition text-base">
              <div class="relative">
                <Icon name="heroicons:heart" class="w-5 h-5" />
                <span v-if="wishlistCount > 0" 
                      class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">
                  {{ wishlistCount }}
                </span>
              </div>
              Lista de deseos
            </button>
            <button @mousedown.prevent="goToOrders"
           
              class="flex items-center gap-3 px-5 py-3 text-gray-700 hover:bg-gray-50 transition text-base">
              <Icon name="heroicons:cube" class="w-5 h-5" />
              Pedidos
            </button>
            <button @mousedown.prevent="logout"
              class="flex items-center gap-3 px-5 py-3 w-full text-left text-gray-700 hover:bg-gray-50 transition text-base">
              <Icon name="heroicons:arrow-left-on-rectangle" class="w-5 h-5" />
              Cerrar sesión
            </button>
          </div>
        </div>
        <div v-else>
          <NuxtLink to="/login" class="flex items-center gap-2 text-sm font-medium text-gray-700 hover:text-red-500">
            <svg width="23" height="25" viewBox="0 0 23 25" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M21.4998 24.0007V21.4451C21.4998 20.0895 20.973 18.7895 20.0353 17.831C19.0977 16.8725 17.8259 16.334 16.4998 16.334H6.49982C5.17373 16.334 3.90196 16.8725 2.96428 17.831C2.0266 18.7895 1.49982 20.0895 1.49982 21.4451V24.0007"
                stroke="#272A30" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
              <path
                d="M11.4998 11.2222C14.2612 11.2222 16.4998 8.9339 16.4998 6.11111C16.4998 3.28832 14.2612 1 11.4998 1C8.73839 1 6.49982 3.28832 6.49982 6.11111C6.49982 8.9339 8.73839 11.2222 11.4998 11.2222Z"
                stroke="#272A30" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
            Iniciar sesión
          </NuxtLink>
        </div>
        <CartButton />
        <!-- Redes sociales dropdown -->
        <div class="relative group">
          <button class="p-2 rounded-md flex items-center gap-2 bg-white text-secondary hover:bg-gray-100">
            <Icon name="mdi:instagram" class="w-6 h-6 text-secondary" />
            <Icon name="heroicons:chevron-down" class="w-4 h-4 text-secondary" />
          </button>
          <div class="absolute top-10 right-0 bg-white shadow-lg rounded-md w-48 hidden group-hover:block z-10">
            <ul class="py-2">
              <li v-for="social in socialMedia" :key="social.name" class="hover:bg-gray-100">
                <a :href="social.url" class="flex items-center px-4 py-2">
                  <Icon :name="social.icon" class="w-5 h-5 mr-2" /> {{ social.name }}
                </a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- Navigation -->
    <nav class="bg-secondary text-white relative">
      <div class="container-custom flex items-center overflow-x-auto scrollbar-hide w-full" v-if="!isMobile">

        <div class="hidden md:flex items-center w-full">
          <!-- Botón fijo a la izquierda -->
          <div class="flex-shrink-0">
            <div class="relative">
              <button 
                @click="toggleCategoriesMenu"
                class="nav-link py-3 px-8 flex items-center w-full h-full min-w-[120px] justify-center">
                Todas las categorías
                <Icon name="heroicons:chevron-right" class="w-4 h-4 ml-1" />
              </button>
            </div>
          </div>
          
          <!-- Categorías scrolleables -->
          <div class="flex-1 overflow-x-auto scrollbar-hide">
            <ul class="flex flex-nowrap items-center gap-2">
              <li v-for="category in categories.slice(0, 20)" :key="category.id" class="flex-shrink-0">
                <NuxtLink :to="`/category/${category.slug}`"
                  class="nav-link py-3 px-8 block whitespace-nowrap min-w-[120px] text-center">
                  {{ category.name }}
                </NuxtLink>
              </li>
            </ul>
          </div>
        </div>

        <div class="md:hidden ml-auto ">
          <svg width="34" height="28" viewBox="0 0 34 28" fill="none" xmlns="http://www.w3.org/2000/svg"
            v-if="!mobileMenuOpen">
            <rect width="34" height="6" rx="2" fill="#272A30" />
            <rect y="11" width="34" height="6" rx="2" fill="#272A30" />
            <rect y="22" width="34" height="6" rx="2" fill="#272A30" />
          </svg>
          <svg v-else width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="15.0437" y="0.302734" width="1" height="20.8517" rx="0.5" transform="rotate(45 15.0437 0.302734)"
              fill="#CCCCCC" />
            <rect x="15.3162" y="14.9961" width="1" height="20.7454" rx="0.5" transform="rotate(135 15.3162 14.9961)"
              fill="#CCCCCC" />
          </svg>
        </div>
      </div>



    </nav>
  </header>
  
  <!-- Sidebar fuera del header para evitar problemas de overflow -->
  <Transition name="mobile-menu">
    <div v-if="mobileMenuOpen" class="fixed top-0 left-0 bg-white h-full shadow-lg z-[9999] overflow-y-auto border-2 border-red-500"
         :class="isMobile ? 'w-4/5' : 'w-80'"
         style="transform: translateX(0);"
         @mounted="console.log('Sidebar mounted')">
      <!-- Header del menú lateral -->
      <div class="flex justify-between items-center p-4 border-b border-gray-100">
        <h3 class="font-semibold text-gray-800">Todas las categorías</h3>
        <button @click="closeMobileMenu" class="p-2">
          <svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="15.0437" y="0.302734" width="1" height="20.8517" rx="0.5"
              transform="rotate(45 15.0437 0.302734)" fill="#CCCCCC" />
            <rect x="15.3162" y="14.9961" width="1" height="20.7454" rx="0.5"
              transform="rotate(135 15.3162 14.9961)" fill="#CCCCCC" />
          </svg>
        </button>
      </div>

      <!-- Usuario -->
      <div class="flex items-center gap-4 p-4 border-b border-gray-100">
        <svg width="30" height="34" viewBox="0 0 30 34" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M28.0812 32.0798V28.7472C28.0812 26.9795 27.3942 25.2842 26.1714 24.0342C24.9486 22.7843 23.2902 22.082 21.5609 22.082H8.5203C6.79101 22.082 5.13254 22.7843 3.90975 24.0342C2.68696 25.2842 2 26.9795 2 28.7472V32.0798"
            stroke="#272A30" stroke-width="2.60812" stroke-linecap="round" stroke-linejoin="round" />
          <path
            d="M15.0406 15.4202C18.6416 15.4202 21.5609 12.4361 21.5609 8.75504C21.5609 5.07395 18.6416 2.08984 15.0406 2.08984C11.4395 2.08984 8.52026 5.07395 8.52026 8.75504C8.52026 12.4361 11.4395 15.4202 15.0406 15.4202Z"
            stroke="#272A30" stroke-width="2.60812" stroke-linecap="round" stroke-linejoin="round" />
        </svg>
        <span class="font-medium"
        @click="userName ? '' : $router.push('/login')"
        >{{ userName ? userName : 'Iniciar sesión' }}</span>
      </div>

      <!-- Categorías desplegable -->
      <div class="border-b border-gray-100">
        <button @click="toggleCategoriesMobile" class="w-full flex justify-between items-center p-4 text-left">
          <span class="font-medium text-gray-800">Categorías</span>
          <Icon :name="categoriesMobileOpen ? 'heroicons:chevron-up' : 'heroicons:chevron-down'"
            class="w-5 h-5 text-gray-500 transition-transform duration-200"
            :class="{ 'rotate-180': categoriesMobileOpen }" />
        </button>
        <Transition name="dropdown">
          <div v-if="categoriesMobileOpen" class="bg-gray-50 overflow-hidden">
            <NuxtLink v-for="category in categories" :key="category.id" :to="`/category/${category.slug}`"
              @click="closeMobileMenu"
              class="block px-6 py-3 text-gray-700 hover:bg-gray-100 hover:text-secondary transition-all duration-200 transform hover:translate-x-1">
              {{ category.name }}
            </NuxtLink>
          </div>
        </Transition>
      </div>

      <!-- Redes sociales desplegable -->
      <div class="border-b border-gray-100">
        <button @click="toggleSocialMobile" class="w-full flex justify-between items-center p-4 text-left">
          <span class="font-medium text-gray-800">Redes sociales</span>
          <Icon :name="socialMobileOpen ? 'heroicons:chevron-up' : 'heroicons:chevron-down'"
            class="w-5 h-5 text-gray-500 transition-transform duration-200"
            :class="{ 'rotate-180': socialMobileOpen }" />
        </button>
        <Transition name="dropdown">
          <div v-if="socialMobileOpen" class="bg-gray-50 overflow-hidden">
            <a v-for="social in socialMedia" :key="social.name" :href="social.url"
              class="group flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100 hover:text-secondary transition-all duration-200 transform hover:translate-x-1">
              <Icon :name="social.icon"
                class="w-5 h-5 mr-3 transition-transform duration-200 group-hover:scale-110" />
              {{ social.name }}
            </a>
          </div>
        </Transition>
      </div>

      <!-- Enlaces adicionales -->
      <div class="p-4">
        <NuxtLink to="/account"
        @click="closeMobileMenu"
        class="flex items-center gap-3 py-3 text-gray-700 hover:bg-gray-50 transition text-base border-b border-gray-100">
              <Icon name="heroicons:user-circle" class="w-5 h-5" />
              Mi cuenta
            </NuxtLink> 
        <NuxtLink to="/wishlist" @click="closeMobileMenu"
          class="flex items-center gap-3 py-3 text-gray-700 hover:text-secondary transition">
          <Icon name="heroicons:heart" class="w-5 h-5" />
          Lista de deseos
        </NuxtLink>
        <NuxtLink to="/orders" @click="closeMobileMenu"
          class="flex items-center gap-3 py-3 text-gray-700 hover:text-secondary transition">
          <Icon name="heroicons:cube" class="w-5 h-5" />
          Pedidos
        </NuxtLink>
        <button @click="logout"
          class="flex items-center gap-3 py-3 w-full text-left text-gray-700 hover:text-secondary transition">
          <Icon name="heroicons:arrow-left-on-rectangle" class="w-5 h-5" />
          Cerrar sesión
        </button>
      </div>
    </div>
  </Transition>

  <!-- Backdrop fuera del header -->
  <Transition name="mobile-menu">
    <div v-if="mobileMenuOpen" @click="closeMobileMenu" class="fixed inset-0 bg-black bg-opacity-50 z-[9998]" 
         @mousedown.prevent @click.stop></div>
  </Transition>
</template>

<script setup>

import { useCategoryStore } from '~/stores/category';
import { useUserStore } from '~/stores/user'
import { useWishlistStore } from '~/stores/wishlist'
import { onMounted, watchEffect, ref } from 'vue'
import { useRouter } from 'vue-router'
import { useScreenSize } from '~/composables/useScreenSize';
const { isMobile, isTablet, isDesktop } = useScreenSize();
const categoryStore = useCategoryStore();
const categories = computed(() => categoryStore.categories)
const userStore = useUserStore()
const wishlistStore = useWishlistStore();
const wishlistCount = computed(() => wishlistStore.wishlistCount)
onMounted(() => {
  userStore.syncFromLocalStorage()
  window.addEventListener('storage', userStore.syncFromLocalStorage)
})

onBeforeUnmount(() => {
  window.removeEventListener('storage', userStore.syncFromLocalStorage)
})
const userName = computed(() => userStore.name)
const userMenuOpen = ref(false);

const socialMedia = [
  { name: 'Instagram', url: 'https://www.instagram.com/probusinesspe/', icon: 'mdi:instagram' },
  { name: 'Facebook', url: 'https://www.facebook.com/Probusinesspe/', icon: 'mdi:facebook' },
  { name: 'Youtube', url: 'https://www.youtube.com/@MiguelVillegasImportaciones', icon: 'mdi:youtube' },
  { name: 'Tiktok', url: 'https://www.tiktok.com/@pro_business_impo?lang=es', icon: 'mdi:tik_tok' }
];

const mobileMenuOpen = ref(false);
const categoriesOpen = ref(false);
const categoriesMobileOpen = ref(false);
const socialMobileOpen = ref(false);
const router = useRouter()



const toggleMobileMenu = () => {
  mobileMenuOpen.value = !mobileMenuOpen.value;
  if (!mobileMenuOpen.value) {
    categoriesOpen.value = false;
    categoriesMobileOpen.value = false;
    socialMobileOpen.value = false;
  }
};

const toggleCategoriesMenu = () => {
  mobileMenuOpen.value = true;
};

const toggleCategoriesMobile = () => {
  categoriesMobileOpen.value = !categoriesMobileOpen.value;
  if (categoriesMobileOpen.value) {
    socialMobileOpen.value = false;
  }
};

const toggleSocialMobile = () => {
  socialMobileOpen.value = !socialMobileOpen.value;
  if (socialMobileOpen.value) {
    categoriesMobileOpen.value = false;
  }
};

const closeMobileMenu = () => {
  mobileMenuOpen.value = false;
  categoriesMobileOpen.value = false;
  socialMobileOpen.value = false;
};

const toggleCategoriesDropdown = () => {
  categoriesOpen.value = !categoriesOpen.value;
};

const closeAllMenus = () => {
  mobileMenuOpen.value = false;
  categoriesOpen.value = false;
  categoriesMobileOpen.value = false;
  socialMobileOpen.value = false;
};

function logout() {
  userStore.logout()
  router.push('/login')
}

// Close menus when window is resized (only for mobile to tablet transition)
const handleResize = () => {
  if (window.innerWidth < 768 && window.innerWidth > 0) {
    closeAllMenus();
  }
};

// Ensure categories are loaded and set up resize listener
onMounted(() => {
  
  // Cargar lista de deseos si el usuario está autenticado
  
  window.addEventListener('resize', handleResize);
});

// Clean up resize listener
onBeforeUnmount(() => {
  window.removeEventListener('resize', handleResize);
});
const goToWishlist = () => {
  router.push('/wishlist')
}
const goToOrders = () => {
  router.push('/orders')
}


</script>
<style scoped>
/* Oculta la barra de scroll pero permite desplazamiento */
.scrollbar-hide::-webkit-scrollbar {
  display: none;
}

.scrollbar-hide {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

/* Animaciones para el menú lateral */
.mobile-menu-enter-active,
.mobile-menu-leave-active {
  transition: all 0.3s ease;
}

.mobile-menu-enter-from,
.mobile-menu-leave-to {
  opacity: 0;
  transform: translateX(-100%);
}

.mobile-menu-enter-to,
.mobile-menu-leave-from {
  opacity: 1;
  transform: translateX(0);
}

/* Estilos específicos para desktop */
@media (min-width: 1024px) {
  .mobile-menu-enter-active,
  .mobile-menu-leave-active {
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }
}

/* Estilos para las listas desplegables */
.dropdown-enter-active,
.dropdown-leave-active {
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  overflow: hidden;
}

.dropdown-enter-from,
.dropdown-leave-to {
  opacity: 0;
  max-height: 0;
  transform: translateY(-10px);
}

.dropdown-enter-to,
.dropdown-leave-from {
  opacity: 1;
  max-height: 500px;
  transform: translateY(0);
}

/* Animación para los iconos de chevron */
.rotate-180 {
  transform: rotate(180deg);
}

/* Animación para los elementos de la lista */
.dropdown-enter-active .block,
.dropdown-enter-active .flex {
  animation: slideIn 0.3s ease forwards;
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateX(-20px);
  }

  to {
    opacity: 1;
    transform: translateX(0);
  }
}

/* Delay escalonado para los elementos de la lista */
.dropdown-enter-active .block:nth-child(1),
.dropdown-enter-active .flex:nth-child(1) {
  animation-delay: 0.1s;
}

.dropdown-enter-active .block:nth-child(2),
.dropdown-enter-active .flex:nth-child(2) {
  animation-delay: 0.15s;
}

.dropdown-enter-active .block:nth-child(3),
.dropdown-enter-active .flex:nth-child(3) {
  animation-delay: 0.2s;
}

.dropdown-enter-active .block:nth-child(4),
.dropdown-enter-active .flex:nth-child(4) {
  animation-delay: 0.25s;
}

.dropdown-enter-active .block:nth-child(5),
.dropdown-enter-active .flex:nth-child(5) {
  animation-delay: 0.3s;
}

/* Estilos para el dropdown de categorías en desktop */
.nav-link {
  position: relative;
  transition: all 0.2s ease;
}

.nav-link:hover {
  background-color: rgba(255, 255, 255, 0.1);
}

/* Asegurar que el dropdown no se corte */
.group:hover .absolute {
  display: block !important;
}
</style>